<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>deep-query - deepjs Javascript Framework</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="deepjs Javascript Framework"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.rc</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/deep.html">deep</a></li>
            
                <li><a href="../classes/deep.Chain.html">deep.Chain</a></li>
            
                <li><a href="../classes/deep.collider.html">deep.collider</a></li>
            
                <li><a href="../classes/deep.collider.array.html">deep.collider.array</a></li>
            
                <li><a href="../classes/deep.collider.assert.html">deep.collider.assert</a></li>
            
                <li><a href="../classes/deep.collider.object.html">deep.collider.object</a></li>
            
                <li><a href="../classes/deep.compose.html">deep.compose</a></li>
            
                <li><a href="../classes/deep.Composer.html">deep.Composer</a></li>
            
                <li><a href="../classes/deep.deep.html">deep.deep</a></li>
            
                <li><a href="../classes/deep.Deferred.html">deep.Deferred</a></li>
            
                <li><a href="../classes/deep.Promise.html">deep.Promise</a></li>
            
                <li><a href="../classes/deep.Query.html">deep.Query</a></li>
            
                <li><a href="../classes/deep.Role.html">deep.Role</a></li>
            
                <li><a href="../classes/deep.roles.html">deep.roles</a></li>
            
                <li><a href="../classes/deep.store.html">deep.store</a></li>
            
                <li><a href="../classes/deep.store.Array.html">deep.store.Array</a></li>
            
                <li><a href="../classes/deep.store.Object.html">deep.store.Object</a></li>
            
                <li><a href="../classes/deep.store.Store.html">deep.store.Store</a></li>
            
                <li><a href="../classes/deep.stores.html">deep.stores</a></li>
            
                <li><a href="../classes/deep.stores.aspect.html">deep.stores.aspect</a></li>
            
                <li><a href="../classes/deep.stores.instance.html">deep.stores.instance</a></li>
            
                <li><a href="../classes/deep.stores.js.html">deep.stores.js</a></li>
            
                <li><a href="../classes/deep.stores.queryThis.html">deep.stores.queryThis</a></li>
            
                <li><a href="../classes/deep.utils.html">deep.utils</a></li>
            
                <li><a href="../classes/deep.Validator.html">deep.Validator</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/deep.html">deep</a></li>
            
                <li><a href="../modules/deep-collider.html">deep-collider</a></li>
            
                <li><a href="../modules/deep-compose.html">deep-compose</a></li>
            
                <li><a href="../modules/deep-query.html">deep-query</a></li>
            
                <li><a href="../modules/deep-roles.html">deep-roles</a></li>
            
                <li><a href="../modules/deep-rql.html">deep-rql</a></li>
            
                <li><a href="../modules/deep-schema.html">deep-schema</a></li>
            
                <li><a href="../modules/deep-stores.html">deep-stores</a></li>
            
                <li><a href="../modules/utils.html">utils</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1>deep-query Module</h1>
<div class="box clearfix meta">
    

    

    
        <div class="foundat">
            Defined in: <a href="../files/deep-query.js.html#l198"><code>deep-query.js:198</code></a>
        </div>
    

    
</div>



<div class="box intro">
    <p>A other proposal for (json/object)-query which (as differences from official proposal):
     - use simple slash delimitted syntax, 
     - could handle regular expression for step selection, 
     - could handle rql (for filtering) on each step selection,
     - could be relative to where the query are placed in a object/json
     - so could handle steps toward any ancestor
     - could handle json-schema in rql filtering
     - could handle ancestor in rql filtering</p>
</div>


    <div class="example">
        <h4>Example:</h4>
        <div class="example-content">
            <h1> deep-query : tools to query json/object structures. </h1>

<p>see Docs/deep-query.md   for full documentations</p>

<h2>Queries examples:  the result is always the result of the last step.</h2>

<p>/foo/bar/
From root : Select from root the property foo then give me the property bar in it</p>

<p>../foo/bar?zoo.name//price?=in=(12,55)
From ME (somewhere in a json/object) : Give me in my parent the property named foo
On this, give me 'bar' which has a property 'zoo' which has a property 'name'
On this give me any price (at any sublevel) equal to 12 or 55</p>

<p>//(p.+)gi/../../foo//bar?=3
From root : Give me recursively any property which its name correspond to (p.+)gi.
on this, take the parent of its parent (if any).
on this : take 'foo'.
on this : recursively take any property named bar and equal to 3</p>

<p>/?foo=2&amp;bar/(myArray.<em>)?length=gt=10/[1:4:2,@.length-2]//(^p.</em>)g?=in=(hello,bye)&amp;<em>parent.taxerate=lt=0.12&amp;</em>schema.type=string
From root : Give me any property. 
On this : give me those which have a property named foo and equal to 2 AND has a property named bar (different of undefined, null, false, or 0).
On this : select any property named myArray.* (RegExp) where length > 10.
On this : give me property (if any) named 1 or 3 or an index equal to parent.length-2 (parent is myAtrray.<em>).
On this : Recursively give me any property where its name correspond to (^p.</em>)g AND where its value is either 'hello' or 'bye'
    AND its parent has a property taxerate less than 0,12
    AND its type is 'string'</p>

<h2>Syntaxe</h2>

<p>A query consist of succession of steps.</p>

<p>A step is : 
move selector ? rql</p>

<h3>Start (first move)</h3>

<p>/    start from root
./    start from me (from somewhere in a json/object)
../ start from my parent (from somewhere in a json/object)
//     start from root and give me any properties at any sub level</p>

<h3>Moves</h3>

<p>/         current level
//        recursively seek any property from current level
../        take my parent level (you could select any of its properties from there)
../!    take my parent reference (you need to add '/' (e.g. ../!/) to select any of its properties as above))
/!        will give you current reference</p>

<h3>Selector</h3>

<p>any step selector is either a direct string, or an int (array index) or a regular expression, or a union of them (expressed as a coma separated list of them surrounded with square brackets).
You could express range of array indexes as 0:10:2 which says : take items from 0 to 10 (included) by step of two. (see examples below for optionals placement)
Regular expression are always surrounded by parenthesis, and could be ended with 'g', 'i' or 'gi'.</p>

<p>examples of valid selectors : 
1
foo
(foo.<em>)
[0:20:2]
[:]
[1:,hello,(^prop.</em>)gi]</p>

<p>query example :
/foo/1/(^bar)/[::2]
Say : give me foo from root,
on this, give the first items (or any property called '1'),
on this, give me any property named bar... ,
on this, get all items by step of two (if any). (it's the result of the query) </p>

<p>All those below are equivalent and say : give me all properties or items of the last move
/(.<em>)
/</em>
/[]
/</p>

<h4>Length cases :</h4>

<p>In array brackets access : you could use @.length to get the length (if any) of the parent IF IT'S AN ARRAY.
example : 
//[@.length-1] <br />
will give you any last array childs at any level from root.</p>

<p>//length
will give you any array length at any level from root (or any 'length' property founded in the json/object)</p>

<p>In deep-rql : length could also give you the length of the strings.</p>

<h3>Filter</h3>

<p>any RQL filter (deep-rql : see its doc for full description) could be added to any selector.</p>

<p>examples :</p>

<p>/foo?=gt=12
give me foo property from root only if it's greater than 12</p>

<p>//address?zip=1190
give me any adress which contains a zip equal to 1190</p>

<p>//category?distinct()&amp;sort(-)
give me any distinct category and sort them descendant</p>

<h2>Concreet usage example</h2>

<p>Here's an example on how to query some JSON/object with deep-query:</p>

<pre class="code prettyprint"><code>var Querier = require("deep/deep-query");
var json = {
    // ....
};
var schema = {
    // content schema
};
var res = Querier.query(object, "/my/path/[0]",{schema:schema});     // options with schema are optional
res.forEach(function(e){
    console.log("result : ",e)
})
</code></pre>
        </div>
    </div>


<div class="yui3-g">
    <div class="yui3-u-1-2">
        
            <p>This module provides the following classes:</p>

            <ul class="module-classes">
            
                <li class="module-class">
                    <a href="../classes/deep.Query.html">
                        deep.Query
                    </a>
                </li>
            
            </ul>
        
    </div>

    <div class="yui3-u-1-2">
        
    </div>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
