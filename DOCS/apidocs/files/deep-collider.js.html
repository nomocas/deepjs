<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>deep-collider.js - deepjs Javascript Framework</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="deepjs Javascript Framework"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.0.rc</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/deep.html">deep</a></li>
            
                <li><a href="../classes/deep.Chain.html">deep.Chain</a></li>
            
                <li><a href="../classes/deep.collider.html">deep.collider</a></li>
            
                <li><a href="../classes/deep.collider.array.html">deep.collider.array</a></li>
            
                <li><a href="../classes/deep.collider.assert.html">deep.collider.assert</a></li>
            
                <li><a href="../classes/deep.collider.object.html">deep.collider.object</a></li>
            
                <li><a href="../classes/deep.compose.html">deep.compose</a></li>
            
                <li><a href="../classes/deep.Composer.html">deep.Composer</a></li>
            
                <li><a href="../classes/deep.deep.html">deep.deep</a></li>
            
                <li><a href="../classes/deep.Deferred.html">deep.Deferred</a></li>
            
                <li><a href="../classes/deep.Promise.html">deep.Promise</a></li>
            
                <li><a href="../classes/deep.Query.html">deep.Query</a></li>
            
                <li><a href="../classes/deep.Role.html">deep.Role</a></li>
            
                <li><a href="../classes/deep.roles.html">deep.roles</a></li>
            
                <li><a href="../classes/deep.stores.html">deep.stores</a></li>
            
                <li><a href="../classes/deep.stores.Array.html">deep.stores.Array</a></li>
            
                <li><a href="../classes/deep.stores.aspect.html">deep.stores.aspect</a></li>
            
                <li><a href="../classes/deep.stores.instance.html">deep.stores.instance</a></li>
            
                <li><a href="../classes/deep.stores.js.html">deep.stores.js</a></li>
            
                <li><a href="../classes/deep.stores.Object.html">deep.stores.Object</a></li>
            
                <li><a href="../classes/deep.stores.queryThis.html">deep.stores.queryThis</a></li>
            
                <li><a href="../classes/deep.stores.Store.html">deep.stores.Store</a></li>
            
                <li><a href="../classes/deep.utils.html">deep.utils</a></li>
            
                <li><a href="../classes/deep.Validator.html">deep.Validator</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/deep.html">deep</a></li>
            
                <li><a href="../modules/deep-collider.html">deep-collider</a></li>
            
                <li><a href="../modules/deep-compose.html">deep-compose</a></li>
            
                <li><a href="../modules/deep-query.html">deep-query</a></li>
            
                <li><a href="../modules/deep-roles.html">deep-roles</a></li>
            
                <li><a href="../modules/deep-rql.html">deep-rql</a></li>
            
                <li><a href="../modules/deep-schema.html">deep-schema</a></li>
            
                <li><a href="../modules/deep-stores.html">deep-stores</a></li>
            
                <li><a href="../modules/utils.html">utils</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: deep-collider.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 *
 *
 *
 * layer-data-composition : inspired by Compose, it offer a large set of tools that permit to manipulate values 
 * from within the object used as layer when applied together. 
 * As Compose merge two prototype by wrapping collided functions by appropriate Compose method (after, before, around),
 * layer-compose do the same by applying a function when values are collided with that function.
 *
 * If you know photoshop : it&#x27;s an equivalent of the fusion modes between two layers (or part of two layers). 
 *
 * 
 * @module deep
 * @submodule deep-collider
 * @author Gilles Coomans &lt;gilles.coomans@gmail.com&gt;
 */
if(typeof define !== &#x27;function&#x27;)
	var define = require(&#x27;amdefine&#x27;)(module);

/*

 * TODO : implement almost every operations, few are done. Will be made on-need.

Remarque : 
Almost totaly unusable for now... ;)
But you could do it for us...;)

 */

define(function(require)
{
	/**
	 * the collider interface
	 * @namespace deep
	 * @class collider
	 * @static
	 */

	return {
		/**
		 * wrap wrapped function with wrapper function. wrapped will receive ollided value as argument.
		 * @method wrap
	 	 * @static
		 * @param  {Function} wrapper
		 * @param  {Function} wrapped
		 * @return {Function} the wrapper
		 */
		wrap:function(wrapper, wrapped){
			var a = function(value, parent, key){
				return wrapper(wrapped(value, parent, key), parent, key);
			};
			a._deep_collider = true;
			return a;
		},
		/**
		 * copy collided value somewhere
		 * @method copyTo
	 	 * @static
		 * @param  {Object} object where copy value
		 * @param  {String} path a dot delimitted path in object where copy value
		 * @return {Function} the collider
		 */
		copyTo:function(object, path){
			var a = function(value, parent, key){
				utils.setValueByPath(object, path, value);
				return value;
			};
			a._deep_collider = true;
			return a;
		},
		/**
		 * simply wrap collided value by wrapper function
		 * @method around
	 	 * @static
		 * @param  {Function} wrapper
		 * @return {Function} the collider
		 */
		around:function(wrapper){
			var a = function (value, parent, key) {
				return wrapper(value);
			}
			a._deep_collider = true;
			return a;
		},
		/**
		 * replace collided value by new one
		 * @method replace
	 	 * @static
		 * @param  {Object} newValue the value to assign
		 * @return {Function} the collider
		 */
		replace:function(newValue){
			var a = function(value, parent, key){
				parent[key] = newValue;
				return newValue;
			};
			a._deep_collider = true;
			return a;
		},

		/**
		 * log collided value
		 * @method log
	 	 * @static
		 * @return {Function} the collider
		 */
		log:function(){
			//console.log(&quot;add layer composition : log&quot;)
			var a =function(value){
				console.log(&quot;deep.collider : log : &quot;,value);
				return value;
			};
			a._deep_collider = true;
			return  a;
		},
		/**
		 * validate collided value with provided schema.
		 * throw an error with report if not valid.
		 * @method validate
	 	 * @static
		 * @param  {Object} schema
		 * @return {Function} the collider
		 */
		validate:function(schema){
			var a = function(value){
				var report = validator.validate(value, schema);
				if(!report.valid)
					throw new Error(report);
				return value;
			}
			a._deep_collider = true;
			return a;
		},
		/**
		 * remove collided value
	 	 * @static
		 * @method remove
		 * @return {Function} the collider
		 */
		remove:function(){
			var a = function(value, parent, key)
			{
				delete parent[key];
				return undefined;
			}
			a._deep_colliderRemove = true;
			return a;
		},
		/**
		 * @for collider
		 * @class deep.collider.assert
		 */
		assert:{
			/**
			 * assert is true on collided value. 
			 * @method isTrue
	 		 * @static
			 * @return {Function} the collider
			 */
			isTrue:function(){
				return function(value){
					console.assert(value === true);
					return value;
				}
				a._deep_collider = true;
				return a;
			},
			isFalse:function(){
				var a = function(value){
					console.assert(value === false);
					return value;
				}
				a._deep_collider = true;
				return a;
			},
			/**
			 * test equality (deep-equal) with collided value
			 * @param  {Object} equalTo the object to test
	 		 * @static
			 * @return {Function} te collider
			 */
			equal:function(equalTo){
				var a = function(value){
					return value == equalTo;
				}
				a._deep_collider = true;
				return a;
			},
			notEqual:function(notEqualTo){
				var a = function(value){
					return value != notEqualTo;
				}
				a._deep_collider = true;
				return a;
			},
			isNumber:function(){
				var a = function(value){
					return !isNaN(value) &amp;&amp; isFinite(value);
				}
				a._deep_collider = true;
				return a;
			}
		},
		/**
		 * @for collider
		 * @class deep.collider.array
		 */
		array:{
			/**
			 * reverse collided array
		 	* @method reverse
		 	* @static
			 * @return {Function} the collider
			 */
			reverse:function(){
				var a = function(value){
					if(typeof value.reverse === &#x27;function&#x27;)
						return value.reverse();
					return value;
				}
				a._deep_collider = true;
				return a;
			},
			/**
			 * remove value in array
		 	* @static
		 	 * @method remove
			 * @return {Function} the collider
			 */
			remove:function(what){
				var a = function(value, parent, key){
					if(value &amp;&amp; value.forEach)
						for(var i = 0; i &lt; value.length; i++)
						{
							if(value[i] == what)
							{
								value = value.slice(i,i+1);
								break;
							}
						}
					parent[key] = value;
				}
				a._deep_collider = true;
				return a;
			}
		},
		string:{
		},
		number:{
		},
		/**
		 * @for collider
		 * @class deep.collider.object
		 */
		object:{
			merge:function merge(newObject, overwrite, schema){
				var a = function(oldObject){
					return deepCopy(newObject, oldObject, overwrite, schema);
				}
				a._deep_collider = true;
				return  a;
			},
			replace:function(newObject){
				var a = function(){
					return newObject;
				}
				a._deep_collider = true;
				return  a;
			},
			appendProperty:function(propertyName, propertyValue){
				var a = function(value, parent, key)
				{
					value[propertyName] = propertyValue;
					return value;
				}
				a._deep_collider = true;
				return a;
			}
		},
		&quot;boolean&quot;:{
		},
		&quot;func&quot;:{
			
		}
	}
	
});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
